<!doctype html>
<!--
/*
 * Licensed to Václav Novák under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership. ElasticSearch licenses this
 * file to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
-->
<!--[if lt IE 7 ]> <html lang="en" class="ie6"> <![endif]--> <!--[if IE 7 ]>    <html lang="en" class="ie7"> <![endif]--> <!--[if IE 8 ]>    <html lang="en" class="ie8"> <![endif]--> <!--[if IE 9 ]>    <html lang="en" class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="cs"> <!--<![endif]-->
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>STV Ballot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="shortcut icon" href="favicon.png">
  <link rel="stylesheet" href="css/style.css?v=0.0.1">

  <!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
    <script data-template-name="connections" type="text/x-handlebars">
      <div id="connections">
      <div class="cheader">{{t "_Connections"}}</div>
      {{#each c in clients}}
          <div>{{c.name}}</div>
      {{/each}}
      </div>
    </script>
    <script data-template-name="navigation" type="text/x-handlebars">
       {{t "_Navigation"}}
       {{#each t in tabs}}
           <a {{action changeTab t.tabAction}}{{bindAttr class="t.currentClass"}}>{{t.desc}}</a>
       {{/each}}
    </script>
    <script data-template-name="connecting" type="text/x-handlebars">
       <div>{{t "_Connecting"}}</div>
       {{t "_Host IP address"}} {{view Em.TextField valueBinding="server_ip"}}
       <button {{ action joinSession }}>{{t "_Connect"}}</button>
    </script>
    <script data-template-name="typing" type="text/x-handlebars">
       {{t "_Vote"}}: {{ voteNo }}<br/>
       {{view Ember.Select contentBinding="pilesCaptions" selectionBinding="currentPileCaption"}}
       <button {{ action clearTable }}{{bindAttr disabled="currentPile.pileClosed"}}>{{t "_Start over"}}</button>
       <table class="typing">
       <tr> <td>{{t "_Status"}}</td><!-- indicators row -->
           {{#each b in currentPile.ballots}}
                <td>{{b.errorMessage}}</td>
           {{/each}}
       </tr>
       <tr> <td>{{t "_Invalid"}}</td><!-- Invalid row -->
           {{#each b in currentPile.ballots}}
                <td>{{view Ember.Checkbox checkedBinding="b.invalid" disabledBinding="currentPile.pileClosed"}}</td>
           {{/each}}
       </tr>
       <tr>  <td>{{t "_Empty"}}</td><!-- "Empty" row -->
           {{#each b in currentPile.ballots}}
                <td>{{view Ember.Checkbox checkedBinding="b.empty" disabledBinding="currentPile.pileClosed"}}</td>
           {{/each}}
       </tr>
       <!-- Candidates -->
       {{#each c in candidates}}
       <tr>
           <td {{action addVoteFor c}}>{{c.name}}}</td>
           {{#each b in currentPile.ballots}}
               {{#findBEntry c b}}
                    <td>{{view Em.TextField tabindexBinding="computedindex" valueBinding="bentry.order" disabledBinding="currentPile.pileClosed"}}</td>
               {{/findBEntry}}
           {{/each}}
       </tr>
       {{/each}}
       </table>

       <button {{ action addBallot }}{{bindAttr disabled="currentPile.pileClosed"}}>+</button>
       <div class="done_pane">
       <button {{ action done }}{{bindAttr disabled="currentPile.pileClosed"}}>{{t "_Done"}}</button>
       <button {{ action print }}{{bindAttr disabled="currentPile.pileOpened"}}>{{t "_Export protocol"}}</button>
       </div>
    </script>
    <script data-template-name="vote-running" type="text/x-handlebars">
       {{#if isRunning}}
        <h2>{{t "_Vote Running"}}</h2>
       <div class="vote_control">
       <button class="btn btnfixedbr" {{ action runSTV }}{{bindAttr disabled="cantClose"}}>{{t "_Close counting"}}</button>
       <br/>
       </div>

       <button class="btn btnfixedtr" {{ action printBallots }}{{bindAttr style="printBtnStyle"}}>{{t "_Print ballots"}}</button>
       <div class="progress_table">
       <div>{{t "_Typing progress"}}:</div>
       <table>
       <tr><td>{{t "_Pile"}}</td><td>{{t "_Primary"}}</td><td>{{t "_Crosscheck"}}</td></tr>
       {{#each g in pileGroups}}
           <tr>
            <td>{{g}}</td>
           {{#each p in g}}
            <td>
                <div class="cprogrbr progress progress-striped active" {{bindAttr title="p.progress"}}>
                    <div class="bar" {{bindAttr style="p.progressstyle"}}></div>
                </div>
            </td>
           {{/each}}
            <td>{{g.crosscheckstatus.status}}</td>
            <td><button {{action reopenAction g}}{{bindAttr disabled="g.openPiles"}}>{{t "_Reopen"}}</button></td>
           </tr>
       {{/each}}
       </table>
       </div>
       {{else}}
        <h2>{{t "_Vote Closed"}}</h2>
       <div class="vote_control">
       <button {{ action exportOstv }}>{{t "_Export to OpenSTV"}}</button>
       <br/>
       <button {{ action resetAll }}{{bindAttr disabled="cantReset"}}>{{t "_Prepare new vote"}}</button>
       </div>
       <div class="clearfix result_pane">
       <div>{{t "_Results - Mandates"}}:</div>       
       {{#each m in mandates}}
            {{m.name}}<br/>
       {{/each}}
       </div>

       {{t "_Counting report"}}:
       <div class="report">{{{ report }}}</div>

       <button {{ action exportProtocol }}{{bindAttr disabled="isRunning"}}>{{t "_Export Protocol"}}</button>
       {{/if}}
    </script>
    <script data-template-name="vote-setup" type="text/x-handlebars">
       <h2>{{t "_Vote setup"}}</h2>
       <div class="candidates">
            {{t "_Candidate list"}}
           <div class="clist">
           {{#each c in candidates}}
               {{view Em.TextField valueBinding="c.name"}}
               {{view Ember.Select contentBinding="genders" selectionBinding="c.gender"}}
               <br/>
           {{/each}}
           </div>
           <button class="btn lbtn" {{action shuffle }} {{bindAttr disabled="cantShuffle"}}>{{t "_Shuffle candidates"}}</button>
           <button class="btn rbtn" {{action launch }} {{bindAttr disabled="launchState"}}>{{t "_Launch ballot"}}</button>
       </div>
       <table class="sform">
       <tr><td><label>{{t "_Vote number"}}</label></td>          <td>{{view Em.TextField valueBinding="voteNo"}}</td></tr>
       <tr><td><label>{{t "_Number of candidates"}}</label></td> <td>{{view Em.TextField valueBinding="candidateCount"}}</td></tr>
       <tr><td><label>{{t "_Number of mandates"}}</label></td>   <td>{{view Em.TextField valueBinding="mandateCount"}}</td></tr>
       <tr><td><label>{{t "_Number of ballots"}}</label></td>    <td>{{view Em.TextField valueBinding="ballotCount"}}</td></tr>
       <tr><td colspan="2"><label>
           {{view Ember.Checkbox disabled="disabled" checkedBinding="replacements" classNames="stvb-chkbox"}}
           {{t "_Elect replacement mandates"}}
       </label></td></tr>
       </table>
    </script>
    <script data-template-name="app-setup" type="text/x-handlebars">
       <div class="centeredVerticalWide">{{t "_Enter your name"}}: {{view Em.TextField valueBinding="userName"}}</div>
       {{#each btn in buttons}}
           <button class="centeredVertical" {{ action start btn.ba }} {{bindAttr disabled="btnState"}} >{{ btn.desc }}</button>
       {{/each}}
    </script>
    <script  data-template-name="application" type="text/x-handlebars">
        {{#if isServerMode}}
            {{view templateName="connections"}}
        {{/if}}
        <div id="tabpane"> 
            {{#if tabsEnabled}}
                {{view templateName="navigation"}}
            {{/if}}
            {{outlet}}
            <div id="popup">{{ popup_msg }}<br/>
                <button onclick="document.getElementById('popup').style.display='none';document.getElementById('black_overlay').style.display='none'">{{t "_Cancel"}}</button>
                <button {{ action popupAct }}>OK</button>
            </div>
        </div>
    </script>
</head>
<body>
    <script src="js/libs/jquery-1.7.2.min.js"></script>
    <script src="js/libs/handlebars-1.0.0.beta.6.js"></script>
    <script src="js/libs/ember-1.0.pre.js"></script>
    <script src="js/data.js"></script>
    <script src="js/messages_cs.js"></script>
    <script src="js/stv_czech_greens.js"></script>
    <script src="js/app.js"></script>
    <div id="black_overlay"></div>
</body>
</html>
